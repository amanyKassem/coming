{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/ahmedtaha/Documents/work/react/amany/Archive/src/components/Category.js\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport I18nManager from \"react-native-web/dist/exports/I18nManager\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { Container, Content, Icon, Input } from 'native-base';\nimport styles from \"../../assets/styles\";\nimport i18n from \"../../locale/i18n\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getProviders } from \"../actions\";\nimport Header from \"../common/Header\";\nimport COLORS from \"../consts/colors\";\nimport StarRating from \"react-native-star-rating\";\nimport { useIsFocused } from '@react-navigation/native';\nimport * as Permissions from 'expo-permissions';\nimport * as Location from 'expo-location';\nvar height = Dimensions.get('window').height;\nvar isIOS = Platform.OS === 'ios';\nvar latitudeDelta = 0.922;\nvar longitudeDelta = 0.521;\n\nfunction Category(_ref) {\n  var _route$params2,\n      _this = this;\n\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      search = _useState2[0],\n      setSearch = _useState2[1];\n\n  var _route$params = route.params,\n      title = _route$params.title,\n      type = _route$params.type,\n      category_id = _route$params.category_id;\n  var lang = useSelector(function (state) {\n    return state.lang.lang;\n  });\n  var token = useSelector(function (state) {\n    return state.auth.user ? state.auth.user.data.token : null;\n  });\n  var providers = useSelector(function (state) {\n    return state.categories.providers;\n  });\n  var providersLoader = useSelector(function (state) {\n    return state.categories.loader;\n  });\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      screenLoader = _useState4[0],\n      setScreenLoader = _useState4[1];\n\n  var _useState5 = useState({\n    latitude: '',\n    longitude: '',\n    latitudeDelta: latitudeDelta,\n    longitudeDelta: longitudeDelta\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      mapRegion = _useState6[0],\n      setMapRegion = _useState6[1];\n\n  var mapRef = useRef(null);\n  var isFocused = useIsFocused();\n  var dispatch = useDispatch();\n\n  var fetchData = function fetchData() {\n    var _await$Permissions$as, status, userLocation, _await$Location$getCu, _await$Location$getCu2, latitude, longitude;\n\n    return _regeneratorRuntime.async(function fetchData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setScreenLoader(true);\n            dispatch(getProviders(lang, category_id, false, null, null, null)).then(function () {\n              return setScreenLoader(false);\n            });\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n          case 4:\n            _await$Permissions$as = _context.sent;\n            status = _await$Permissions$as.status;\n            userLocation = {};\n\n            if (!(status !== 'granted')) {\n              _context.next = 11;\n              break;\n            }\n\n            alert('صلاحيات تحديد موقعك الحالي ملغاه');\n            _context.next = 20;\n            break;\n\n          case 11:\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n          case 13:\n            _await$Location$getCu = _context.sent;\n            _await$Location$getCu2 = _await$Location$getCu.coords;\n            latitude = _await$Location$getCu2.latitude;\n            longitude = _await$Location$getCu2.longitude;\n            userLocation = {\n              latitude: latitude,\n              longitude: longitude,\n              latitudeDelta: latitudeDelta,\n              longitudeDelta: longitudeDelta\n            };\n            setMapRegion(userLocation);\n            isIOS ? mapRef.current.animateToRegion(userLocation, 1000) : false;\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    if (isFocused) {\n      fetchData();\n    }\n  }, [isFocused, (_route$params2 = route.params) == null ? void 0 : _route$params2.category_id]);\n\n  var onSearchFilter = function onSearchFilter(keyword) {\n    setScreenLoader(true);\n    setSearch(keyword);\n\n    if (keyword) {\n      dispatch(getProviders(lang, category_id, false, null, null, keyword)).then(function () {\n        return setScreenLoader(false);\n      });\n    }\n\n    dispatch(getProviders(lang, category_id, false, null, null, null)).then(function () {\n      return setScreenLoader(false);\n    });\n  };\n\n  var onNearProvider = function onNearProvider() {\n    setScreenLoader(true);\n    dispatch(getProviders(lang, category_id, false, mapRegion.latitude, mapRegion.longitude, null)).then(function () {\n      return setScreenLoader(false);\n    });\n  };\n\n  var onFarProvider = function onFarProvider() {\n    setScreenLoader(true);\n    dispatch(getProviders(lang, category_id, false, null, null, null)).then(function () {\n      return setScreenLoader(false);\n    });\n  };\n\n  var onRateProvider = function onRateProvider() {\n    setScreenLoader(true);\n    dispatch(getProviders(lang, category_id, true, null, null, null)).then(function () {\n      return setScreenLoader(false);\n    });\n  };\n\n  function renderLoader() {\n    if (screenLoader) {\n      return React.createElement(View, {\n        style: [styles.loading, styles.flexCenter, {\n          height: '100%'\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 17\n        }\n      }, React.createElement(ActivityIndicator, {\n        size: \"large\",\n        color: COLORS.mstarda,\n        style: {\n          alignSelf: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }\n      }));\n    }\n  }\n\n  function Item(_ref2) {\n    var name = _ref2.name,\n        image = _ref2.image,\n        location = _ref2.location,\n        rate = _ref2.rate,\n        id = _ref2.id,\n        index = _ref2.index;\n    return React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        return navigation.navigate('categoryDetails', {\n          id: id,\n          type: type\n        });\n      },\n      style: [styles.borderGray, styles.marginBottom_20, styles.directionRow, styles.Radius_5, {\n        flex: 1,\n        padding: 10\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }\n    }, React.createElement(Image, {\n      source: {\n        uri: image\n      },\n      style: [styles.icon50, styles.Radius_7],\n      resizeMode: 'cover',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }\n    }), React.createElement(View, {\n      style: [{\n        marginLeft: 15,\n        flex: 1\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }\n    }, React.createElement(View, {\n      style: styles.directionRowSpace,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }\n    }, React.createElement(Text, {\n      style: [styles.textRegular, styles.text_gray, styles.textSize_12],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 25\n      }\n    }, name.substr(0, 20)), React.createElement(View, {\n      style: [styles.directionRow],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 25\n      }\n    }, React.createElement(StarRating, {\n      disabled: false,\n      maxStars: 5,\n      rating: rate,\n      fullStarColor: '#fec104',\n      starSize: 10,\n      starStyle: {\n        marginHorizontal: 2\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 29\n      }\n    }))), React.createElement(View, {\n      style: [styles.directionRow, styles.marginTop_5],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }\n    }, React.createElement(Icon, {\n      type: 'MaterialIcons',\n      name: 'location-on',\n      style: [styles.textSize_13, styles.text_mstarda, {\n        marginRight: 5\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 25\n      }\n    }), React.createElement(Text, {\n      style: [styles.textRegular, styles.text_midGray, styles.textSize_12, {\n        lineHeight: 20\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 25\n      }\n    }, location))));\n  }\n\n  function renderNoData() {\n    if (providers && providers.length <= 0) {\n      return React.createElement(View, {\n        style: [styles.directionColumnCenter, styles.Width_100, {\n          height: height - 200\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }\n      }, React.createElement(Image, {\n        source: require(\"../../assets/images/note.png\"),\n        resizeMode: 'contain',\n        style: {\n          alignSelf: 'center',\n          width: 200,\n          height: 200\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }\n      }));\n    }\n\n    return null;\n  }\n\n  return React.createElement(Container, {\n    style: [styles.bg_gray],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, renderLoader(), React.createElement(Content, {\n    contentContainerStyle: [styles.bgFullWidth, styles.bg_gray],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, React.createElement(Header, {\n    navigation: navigation,\n    title: title,\n    filteration: true,\n    onNearProvider: onNearProvider,\n    onFarProvider: onFarProvider,\n    onRateProvider: onRateProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: [styles.Width_90, styles.SelfCenter, styles.marginBottom_20, styles.marginTop_15, {\n      zIndex: -1\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 17\n    }\n  }, React.createElement(Input, {\n    style: [styles.inputSearch, styles.Width_100, {\n      flex: 0\n    }],\n    placeholder: i18n.t('search'),\n    placeholderTextColor: '#fff',\n    onChangeText: function onChangeText(search) {\n      return onSearchFilter(search);\n    },\n    value: search,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  }), React.createElement(Image, {\n    source: require(\"../../assets/images/search.png\"),\n    style: [styles.icon17, {\n      position: 'absolute',\n      right: 15,\n      top: 13\n    }],\n    resizeMode: 'cover',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 21\n    }\n  })), React.createElement(View, {\n    style: [styles.bgFullWidth, styles.bg_White, styles.Width_100, styles.paddingHorizontal_20, {\n      overflow: 'hidden',\n      zIndex: -1\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 17\n    }\n  }, providers && providers.length > 0 ? React.createElement(View, {\n    style: [styles.marginTop_20],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 29\n    }\n  }, React.createElement(FlatList, {\n    data: providers,\n    horizontal: false,\n    showsVerticalScrollIndicator: false,\n    renderItem: function renderItem(_ref3) {\n      var item = _ref3.item,\n          index = _ref3.index;\n      return React.createElement(Item, {\n        id: item.id,\n        name: item.name,\n        image: item.avatar,\n        location: item.address,\n        rate: item.rate,\n        index: index,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 70\n        }\n      });\n    },\n    keyExtractor: function keyExtractor(item) {\n      return item.id;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 33\n    }\n  })) : renderNoData())));\n}\n\nexport default Category;","map":{"version":3,"sources":["/Users/ahmedtaha/Documents/work/react/amany/Archive/src/components/Category.js"],"names":["React","useEffect","useRef","useState","Container","Content","Icon","Input","styles","i18n","useDispatch","useSelector","getProviders","Header","COLORS","StarRating","useIsFocused","Permissions","Location","height","Dimensions","get","isIOS","Platform","OS","latitudeDelta","longitudeDelta","Category","navigation","route","search","setSearch","params","title","type","category_id","lang","state","token","auth","user","data","providers","categories","providersLoader","loader","screenLoader","setScreenLoader","latitude","longitude","mapRegion","setMapRegion","mapRef","isFocused","dispatch","fetchData","then","askAsync","LOCATION","status","userLocation","alert","getCurrentPositionAsync","coords","current","animateToRegion","onSearchFilter","keyword","onNearProvider","onFarProvider","onRateProvider","renderLoader","loading","flexCenter","mstarda","alignSelf","Item","name","image","location","rate","id","index","navigate","borderGray","marginBottom_20","directionRow","Radius_5","flex","padding","uri","icon50","Radius_7","marginLeft","directionRowSpace","textRegular","text_gray","textSize_12","substr","marginHorizontal","marginTop_5","textSize_13","text_mstarda","marginRight","text_midGray","lineHeight","renderNoData","length","directionColumnCenter","Width_100","require","width","bg_gray","bgFullWidth","Width_90","SelfCenter","marginTop_15","zIndex","inputSearch","t","icon17","position","right","top","bg_White","paddingHorizontal_20","overflow","marginTop_20","item","avatar","address"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,MAA1B,EAAkCC,QAAlC,QAAiD,OAAjD;;;;;;;;;AAEA,SAAQC,SAAR,EAAmBC,OAAnB,EAA4BC,IAA5B,EAAkCC,KAAlC,QAA8C,aAA9C;AACA,OAAOC,MAAP;AACA,OAAOC,IAAP;AACA,SAAQC,WAAR,EAAqBC,WAArB,QAAuC,aAAvC;AACA,SAAQC,YAAR;AACA,OAAOC,MAAP;AACA,OAAOC,MAAP;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AACA,SAASC,YAAT,QAA6B,0BAA7B;AACA,OAAO,KAAKC,WAAZ,MAA6B,kBAA7B;AACA,OAAO,KAAKC,QAAZ,MAA0B,eAA1B;AAEA,IAAMC,MAAM,GAAGC,UAAU,CAACC,GAAX,CAAe,QAAf,EAAyBF,MAAxC;AACA,IAAMG,KAAK,GAAGC,QAAQ,CAACC,EAAT,KAAgB,KAA9B;AACA,IAAMC,aAAa,GAAG,KAAtB;AACA,IAAMC,cAAc,GAAG,KAAvB;;AAEA,SAASC,QAAT,OAAsC;AAAA;AAAA;;AAAA,MAAnBC,UAAmB,QAAnBA,UAAmB;AAAA,MAARC,KAAQ,QAARA,KAAQ;;AAAA,kBAEN1B,QAAQ,CAAC,EAAD,CAFF;AAAA;AAAA,MAE3B2B,MAF2B;AAAA,MAEnBC,SAFmB;;AAAA,sBAGGF,KAAK,CAACG,MAHT;AAAA,MAG3BC,KAH2B,iBAG3BA,KAH2B;AAAA,MAGnBC,IAHmB,iBAGnBA,IAHmB;AAAA,MAGZC,WAHY,iBAGZA,WAHY;AAKlC,MAAMC,IAAI,GAAGzB,WAAW,CAAC,UAAA0B,KAAK;AAAA,WAAIA,KAAK,CAACD,IAAN,CAAWA,IAAf;AAAA,GAAN,CAAxB;AACA,MAAME,KAAK,GAAG3B,WAAW,CAAC,UAAA0B,KAAK;AAAA,WAAIA,KAAK,CAACE,IAAN,CAAWC,IAAX,GAAkBH,KAAK,CAACE,IAAN,CAAWC,IAAX,CAAgBC,IAAhB,CAAqBH,KAAvC,GAA+C,IAAnD;AAAA,GAAN,CAAzB;AACA,MAAMI,SAAS,GAAG/B,WAAW,CAAC,UAAA0B,KAAK;AAAA,WAAIA,KAAK,CAACM,UAAN,CAAiBD,SAArB;AAAA,GAAN,CAA7B;AACA,MAAME,eAAe,GAAGjC,WAAW,CAAC,UAAA0B,KAAK;AAAA,WAAIA,KAAK,CAACM,UAAN,CAAiBE,MAArB;AAAA,GAAN,CAAnC;;AARkC,mBASQ1C,QAAQ,CAAC,IAAD,CAThB;AAAA;AAAA,MAS3B2C,YAT2B;AAAA,MASZC,eATY;;AAAA,mBAWA5C,QAAQ,CAAC;AACvC6C,IAAAA,QAAQ,EAAE,EAD6B;AAEvCC,IAAAA,SAAS,EAAE,EAF4B;AAGvCxB,IAAAA,aAAa,EAAbA,aAHuC;AAIvCC,IAAAA,cAAc,EAAdA;AAJuC,GAAD,CAXR;AAAA;AAAA,MAW3BwB,SAX2B;AAAA,MAWhBC,YAXgB;;AAiBlC,MAAIC,MAAM,GAAGlD,MAAM,CAAC,IAAD,CAAnB;AACA,MAAMmD,SAAS,GAAGrC,YAAY,EAA9B;AAEA,MAAMsC,QAAQ,GAAG5C,WAAW,EAA5B;;AAEA,MAAM6C,SAAS,GAAG,SAAZA,SAAY;AAAA;;AAAA;AAAA;AAAA;AAAA;AACdR,YAAAA,eAAe,CAAC,IAAD,CAAf;AACAO,YAAAA,QAAQ,CAAC1C,YAAY,CAACwB,IAAD,EAAQD,WAAR,EAAqB,KAArB,EAA6B,IAA7B,EAAoC,IAApC,EAA2C,IAA3C,CAAb,CAAR,CAAuEqB,IAAvE,CAA4E;AAAA,qBAAMT,eAAe,CAAC,KAAD,CAArB;AAAA,aAA5E;AAFc;AAAA,6CAGS9B,WAAW,CAACwC,QAAZ,CAAqBxC,WAAW,CAACyC,QAAjC,CAHT;;AAAA;AAAA;AAGRC,YAAAA,MAHQ,yBAGRA,MAHQ;AAIVC,YAAAA,YAJU,GAIK,EAJL;;AAAA,kBAKVD,MAAM,KAAK,SALD;AAAA;AAAA;AAAA;;AAMVE,YAAAA,KAAK,CAAC,kCAAD,CAAL;AANU;AAAA;;AAAA;AAAA;AAAA,6CAQwC3C,QAAQ,CAAC4C,uBAAT,CAAiC,EAAjC,CARxC;;AAAA;AAAA;AAAA,2DAQFC,MARE;AAQQf,YAAAA,QARR,0BAQQA,QARR;AAQkBC,YAAAA,SARlB,0BAQkBA,SARlB;AASVW,YAAAA,YAAY,GAAG;AAAEZ,cAAAA,QAAQ,EAARA,QAAF;AAAYC,cAAAA,SAAS,EAATA,SAAZ;AAAuBxB,cAAAA,aAAa,EAAbA,aAAvB;AAAsCC,cAAAA,cAAc,EAAdA;AAAtC,aAAf;AACAyB,YAAAA,YAAY,CAACS,YAAD,CAAZ;AACAtC,YAAAA,KAAK,GAAG8B,MAAM,CAACY,OAAP,CAAeC,eAAf,CAA+BL,YAA/B,EAA6C,IAA7C,CAAH,GAAwD,KAA7D;;AAXU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAgBA3D,EAAAA,SAAS,CAAC,YAAM;AAEZ,QAAIoD,SAAJ,EAAe;AACXE,MAAAA,SAAS;AACZ;AACJ,GALQ,EAKN,CAACF,SAAD,oBAAYxB,KAAK,CAACG,MAAlB,qBAAY,eAAcG,WAA1B,CALM,CAAT;;AAOA,MAAM+B,cAAc,GAAG,SAAjBA,cAAiB,CAACC,OAAD,EAAa;AAChCpB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACAhB,IAAAA,SAAS,CAACoC,OAAD,CAAT;;AACA,QAAIA,OAAJ,EAAa;AACTb,MAAAA,QAAQ,CAAC1C,YAAY,CAACwB,IAAD,EAAQD,WAAR,EAAqB,KAArB,EAA6B,IAA7B,EAAoC,IAApC,EAA2CgC,OAA3C,CAAb,CAAR,CAA0EX,IAA1E,CAA+E;AAAA,eAAMT,eAAe,CAAC,KAAD,CAArB;AAAA,OAA/E;AACH;;AACDO,IAAAA,QAAQ,CAAC1C,YAAY,CAACwB,IAAD,EAAQD,WAAR,EAAqB,KAArB,EAA6B,IAA7B,EAAoC,IAApC,EAA2C,IAA3C,CAAb,CAAR,CAAuEqB,IAAvE,CAA4E;AAAA,aAAMT,eAAe,CAAC,KAAD,CAArB;AAAA,KAA5E;AACH,GAPD;;AASA,MAAMqB,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AACzBrB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACAO,IAAAA,QAAQ,CAAC1C,YAAY,CAACwB,IAAD,EAAQD,WAAR,EAAqB,KAArB,EAA6Be,SAAS,CAACF,QAAvC,EAAiDE,SAAS,CAACD,SAA3D,EAAuE,IAAvE,CAAb,CAAR,CAAmGO,IAAnG,CAAwG;AAAA,aAAMT,eAAe,CAAC,KAAD,CAArB;AAAA,KAAxG;AACH,GAHD;;AAKA,MAAMsB,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AACxBtB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACAO,IAAAA,QAAQ,CAAC1C,YAAY,CAACwB,IAAD,EAAQD,WAAR,EAAqB,KAArB,EAA6B,IAA7B,EAAoC,IAApC,EAA2C,IAA3C,CAAb,CAAR,CAAuEqB,IAAvE,CAA4E;AAAA,aAAMT,eAAe,CAAC,KAAD,CAArB;AAAA,KAA5E;AACH,GAHD;;AAKA,MAAMuB,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AACzBvB,IAAAA,eAAe,CAAC,IAAD,CAAf;AACAO,IAAAA,QAAQ,CAAC1C,YAAY,CAACwB,IAAD,EAAQD,WAAR,EAAqB,IAArB,EAA4B,IAA5B,EAAmC,IAAnC,EAA0C,IAA1C,CAAb,CAAR,CAAsEqB,IAAtE,CAA2E;AAAA,aAAMT,eAAe,CAAC,KAAD,CAArB;AAAA,KAA3E;AACH,GAHD;;AAOA,WAASwB,YAAT,GAAuB;AACnB,QAAIzB,YAAJ,EAAiB;AACb,aACI,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAE,CAACtC,MAAM,CAACgE,OAAR,EAAiBhE,MAAM,CAACiE,UAAxB,EAAoC;AAACtD,UAAAA,MAAM,EAAC;AAAR,SAApC,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,iBAAD;AAAmB,QAAA,IAAI,EAAC,OAAxB;AAAgC,QAAA,KAAK,EAAEL,MAAM,CAAC4D,OAA9C;AAAuD,QAAA,KAAK,EAAE;AAAEC,UAAAA,SAAS,EAAE;AAAb,SAA9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADJ;AAKH;AACJ;;AAED,WAASC,IAAT,QAA+D;AAAA,QAA/CC,IAA+C,SAA/CA,IAA+C;AAAA,QAAxCC,KAAwC,SAAxCA,KAAwC;AAAA,QAAhCC,QAAgC,SAAhCA,QAAgC;AAAA,QAArBC,IAAqB,SAArBA,IAAqB;AAAA,QAAdC,EAAc,SAAdA,EAAc;AAAA,QAATC,KAAS,SAATA,KAAS;AAC3D,WACI,oBAAC,gBAAD;AAAkB,MAAA,OAAO,EAAE;AAAA,eAAMtD,UAAU,CAACuD,QAAX,CAAoB,iBAApB,EAAuC;AAACF,UAAAA,EAAE,EAAFA,EAAD;AAAM/C,UAAAA,IAAI,EAAJA;AAAN,SAAvC,CAAN;AAAA,OAA3B;AAAsF,MAAA,KAAK,EAAE,CAAC1B,MAAM,CAAC4E,UAAR,EAAmB5E,MAAM,CAAC6E,eAA1B,EAA4C7E,MAAM,CAAC8E,YAAnD,EAAkE9E,MAAM,CAAC+E,QAAzE,EAAoF;AAACC,QAAAA,IAAI,EAAC,CAAN;AAAUC,QAAAA,OAAO,EAAC;AAAlB,OAApF,CAA7F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,MAAM,EAAE;AAACC,QAAAA,GAAG,EAACZ;AAAL,OAAf;AAA4B,MAAA,KAAK,EAAE,CAACtE,MAAM,CAACmF,MAAR,EAAiBnF,MAAM,CAACoF,QAAxB,CAAnC;AAAsE,MAAA,UAAU,EAAE,OAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE,CAAC;AAACC,QAAAA,UAAU,EAAC,EAAZ;AAAiBL,QAAAA,IAAI,EAAC;AAAtB,OAAD,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEhF,MAAM,CAACsF,iBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE,CAACtF,MAAM,CAACuF,WAAR,EAAsBvF,MAAM,CAACwF,SAA7B,EAAyCxF,MAAM,CAACyF,WAAhD,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA6EpB,IAAI,CAACqB,MAAL,CAAY,CAAZ,EAAc,EAAd,CAA7E,CADJ,EAEI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE,CAAC1F,MAAM,CAAC8E,YAAR,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,UAAD;AACI,MAAA,QAAQ,EAAE,KADd;AAEI,MAAA,QAAQ,EAAE,CAFd;AAGI,MAAA,MAAM,EAAEN,IAHZ;AAII,MAAA,aAAa,EAAE,SAJnB;AAKI,MAAA,QAAQ,EAAE,EALd;AAMI,MAAA,SAAS,EAAE;AAAEmB,QAAAA,gBAAgB,EAAE;AAApB,OANf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CAFJ,CADJ,EAcI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE,CAAC3F,MAAM,CAAC8E,YAAR,EAAuB9E,MAAM,CAAC4F,WAA9B,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,IAAD;AAAM,MAAA,IAAI,EAAE,eAAZ;AAA6B,MAAA,IAAI,EAAE,aAAnC;AAAkD,MAAA,KAAK,EAAE,CAAC5F,MAAM,CAAC6F,WAAR,EAAsB7F,MAAM,CAAC8F,YAA7B,EAA4C;AAACC,QAAAA,WAAW,EAAC;AAAb,OAA5C,CAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE,CAAC/F,MAAM,CAACuF,WAAR,EAAsBvF,MAAM,CAACgG,YAA7B,EAA4ChG,MAAM,CAACyF,WAAnD,EAAgE;AAACQ,QAAAA,UAAU,EAAC;AAAZ,OAAhE,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAiG1B,QAAjG,CAFJ,CAdJ,CAFJ,CADJ;AAwBH;;AAED,WAAS2B,YAAT,GAAwB;AACpB,QAAIhE,SAAS,IAAKA,SAAD,CAAYiE,MAAZ,IAAsB,CAAvC,EAA0C;AACtC,aACI,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAE,CAACnG,MAAM,CAACoG,qBAAR,EAAgCpG,MAAM,CAACqG,SAAvC,EAAkD;AAAC1F,UAAAA,MAAM,EAACA,MAAM,GAAC;AAAf,SAAlD,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AAAO,QAAA,MAAM,EAAE2F,OAAO,gCAAtB;AAAwD,QAAA,UAAU,EAAE,SAApE;AACO,QAAA,KAAK,EAAE;AAACnC,UAAAA,SAAS,EAAE,QAAZ;AAAsBoC,UAAAA,KAAK,EAAE,GAA7B;AAAkC5F,UAAAA,MAAM,EAAE;AAA1C,SADd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADJ;AAMH;;AAED,WAAO,IAAP;AACH;;AAED,SACI,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,CAACX,MAAM,CAACwG,OAAR,CAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKzC,YAAY,EADjB,EAEI,oBAAC,OAAD;AAAS,IAAA,qBAAqB,EAAE,CAAC/D,MAAM,CAACyG,WAAR,EAAsBzG,MAAM,CAACwG,OAA7B,CAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEI,oBAAC,MAAD;AAAQ,IAAA,UAAU,EAAEpF,UAApB;AAAgC,IAAA,KAAK,EAAGK,KAAxC;AAAgD,IAAA,WAAW,EAAE,IAA7D;AAAmE,IAAA,cAAc,EAAEmC,cAAnF;AAAmG,IAAA,aAAa,EAAEC,aAAlH;AAAiI,IAAA,cAAc,EAAEC,cAAjJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAII,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE,CAAC9D,MAAM,CAAC0G,QAAR,EAAiB1G,MAAM,CAAC2G,UAAxB,EAAqC3G,MAAM,CAAC6E,eAA5C,EAA8D7E,MAAM,CAAC4G,YAArE,EAAoF;AAACC,MAAAA,MAAM,EAAC,CAAC;AAAT,KAApF,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,KAAD;AAAO,IAAA,KAAK,EAAE,CAAC7G,MAAM,CAAC8G,WAAR,EAAsB9G,MAAM,CAACqG,SAA7B,EAAyC;AAACrB,MAAAA,IAAI,EAAC;AAAN,KAAzC,CAAd;AACO,IAAA,WAAW,EAAE/E,IAAI,CAAC8G,CAAL,CAAO,QAAP,CADpB;AAEO,IAAA,oBAAoB,EAAE,MAF7B;AAGO,IAAA,YAAY,EAAE,sBAACzF,MAAD;AAAA,aAAYoC,cAAc,CAACpC,MAAD,CAA1B;AAAA,KAHrB;AAIO,IAAA,KAAK,EAAEA,MAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAQI,oBAAC,KAAD;AAAO,IAAA,MAAM,EAAEgF,OAAO,kCAAtB;AAA0D,IAAA,KAAK,EAAE,CAACtG,MAAM,CAACgH,MAAR,EAAgB;AAACC,MAAAA,QAAQ,EAAC,UAAV;AAAuBC,MAAAA,KAAK,EAAC,EAA7B;AAAkCC,MAAAA,GAAG,EAAC;AAAtC,KAAhB,CAAjE;AAA6H,IAAA,UAAU,EAAE,OAAzI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARJ,CAJJ,EAgBI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE,CAACnH,MAAM,CAACyG,WAAR,EAAqBzG,MAAM,CAACoH,QAA5B,EAAsCpH,MAAM,CAACqG,SAA7C,EAAuDrG,MAAM,CAACqH,oBAA9D,EAAoF;AAACC,MAAAA,QAAQ,EAAC,QAAV;AAAqBT,MAAAA,MAAM,EAAC,CAAC;AAA7B,KAApF,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGQ3E,SAAS,IAAKA,SAAD,CAAYiE,MAAZ,GAAqB,CAAlC,GACI,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE,CAACnG,MAAM,CAACuH,YAAR,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,oBAAC,QAAD;AACI,IAAA,IAAI,EAAErF,SADV;AAEI,IAAA,UAAU,EAAE,KAFhB;AAGI,IAAA,4BAA4B,EAAE,KAHlC;AAII,IAAA,UAAU,EAAE;AAAA,UAAGsF,IAAH,SAAGA,IAAH;AAAA,UAAU9C,KAAV,SAAUA,KAAV;AAAA,aAAqB,oBAAC,IAAD;AAC7B,QAAA,EAAE,EAAE8C,IAAI,CAAC/C,EADoB;AAE7B,QAAA,IAAI,EAAE+C,IAAI,CAACnD,IAFkB;AAG7B,QAAA,KAAK,EAAEmD,IAAI,CAACC,MAHiB;AAI7B,QAAA,QAAQ,EAAED,IAAI,CAACE,OAJc;AAK7B,QAAA,IAAI,EAAEF,IAAI,CAAChD,IALkB;AAM7B,QAAA,KAAK,EAAEE,KANsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAArB;AAAA,KAJhB;AAYI,IAAA,YAAY,EAAE,sBAAA8C,IAAI;AAAA,aAAIA,IAAI,CAAC/C,EAAT;AAAA,KAZtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,CADJ,GAkBIyB,YAAY,EArBxB,CAhBJ,CAFJ,CADJ;AAkDH;;AAED,eAAe/E,QAAf","sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\nimport {View, Text, Image, TouchableOpacity, Dimensions, FlatList, I18nManager, ActivityIndicator} from \"react-native\";\nimport {Container, Content, Icon, Input} from 'native-base'\nimport styles from '../../assets/styles'\nimport i18n from \"../../locale/i18n\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {getProviders} from '../actions';\nimport Header from '../common/Header';\nimport COLORS from \"../consts/colors\";\nimport StarRating from \"react-native-star-rating\";\nimport { useIsFocused } from '@react-navigation/native';\nimport * as Permissions from 'expo-permissions';\nimport * as Location from 'expo-location';\n\nconst height = Dimensions.get('window').height;\nconst isIOS = Platform.OS === 'ios';\nconst latitudeDelta = 0.922;\nconst longitudeDelta = 0.521;\n\nfunction Category({navigation,route}) {\n\n    const [search, setSearch] = useState('');\n    const {title , type , category_id} = route.params;\n\n    const lang = useSelector(state => state.lang.lang);\n    const token = useSelector(state => state.auth.user ? state.auth.user.data.token : null);\n    const providers = useSelector(state => state.categories.providers);\n    const providersLoader = useSelector(state => state.categories.loader);\n    const [screenLoader , setScreenLoader ] = useState(true);\n\n    const [mapRegion, setMapRegion] = useState({\n        latitude: '',\n        longitude: '',\n        latitudeDelta,\n        longitudeDelta\n    });\n    let mapRef = useRef(null);\n    const isFocused = useIsFocused();\n\n    const dispatch = useDispatch();\n\n    const fetchData = async () => {\n        setScreenLoader(true);\n        dispatch(getProviders(lang , category_id, false , null , null , null)).then(() => setScreenLoader(false));\n        let { status } = await Permissions.askAsync(Permissions.LOCATION);\n        let userLocation = {};\n        if (status !== 'granted') {\n            alert('صلاحيات تحديد موقعك الحالي ملغاه');\n        } else {\n            const { coords: { latitude, longitude } } = await Location.getCurrentPositionAsync({});\n            userLocation = { latitude, longitude, latitudeDelta, longitudeDelta };\n            setMapRegion(userLocation);\n            isIOS ? mapRef.current.animateToRegion(userLocation, 1000) : false;\n\n        }\n    }\n\n    useEffect(() => {\n\n        if (isFocused) {\n            fetchData()\n        }\n    }, [isFocused, route.params?.category_id])\n\n    const onSearchFilter = (keyword) => {\n        setScreenLoader(true);\n        setSearch(keyword);\n        if (keyword) {\n            dispatch(getProviders(lang , category_id, false , null , null , keyword)).then(() => setScreenLoader(false));\n        }\n        dispatch(getProviders(lang , category_id, false , null , null , null)).then(() => setScreenLoader(false));\n    }\n\n    const onNearProvider = () => {\n        setScreenLoader(true);\n        dispatch(getProviders(lang , category_id, false , mapRegion.latitude, mapRegion.longitude , null)).then(() => setScreenLoader(false));\n    }\n\n    const onFarProvider = () => {\n        setScreenLoader(true);\n        dispatch(getProviders(lang , category_id, false , null , null , null)).then(() => setScreenLoader(false));\n    }\n\n    const onRateProvider = () => {\n        setScreenLoader(true);\n        dispatch(getProviders(lang , category_id, true , null , null , null)).then(() => setScreenLoader(false));\n    }\n\n\n\n    function renderLoader(){\n        if (screenLoader){\n            return(\n                <View style={[styles.loading, styles.flexCenter, {height:'100%'}]}>\n                    <ActivityIndicator size=\"large\" color={COLORS.mstarda} style={{ alignSelf: 'center' }} />\n                </View>\n            );\n        }\n    }\n\n    function Item({ name , image , location , rate , id , index }) {\n        return (\n            <TouchableOpacity onPress={() => navigation.navigate('categoryDetails', {id , type})} style={[styles.borderGray,styles.marginBottom_20 , styles.directionRow , styles.Radius_5 , {flex:1 , padding:10}]}>\n                <Image source={{uri:image}} style={[styles.icon50 , styles.Radius_7]} resizeMode={'cover'} />\n                <View style={[{marginLeft:15 , flex:1}]}>\n                    <View style={styles.directionRowSpace}>\n                        <Text style={[styles.textRegular , styles.text_gray , styles.textSize_12]}>{ name.substr(0,20) }</Text>\n                        <View style={[styles.directionRow]}>\n                            <StarRating\n                                disabled={false}\n                                maxStars={5}\n                                rating={rate}\n                                fullStarColor={'#fec104'}\n                                starSize={10}\n                                starStyle={{ marginHorizontal: 2 }}\n                            />\n                        </View>\n                    </View>\n                    <View style={[styles.directionRow , styles.marginTop_5]}>\n                        <Icon type={'MaterialIcons'} name={'location-on'} style={[styles.textSize_13 , styles.text_mstarda , {marginRight:5}]} />\n                        <Text style={[styles.textRegular , styles.text_midGray , styles.textSize_12, {lineHeight:20}]}>{ location }</Text>\n                    </View>\n                </View>\n            </TouchableOpacity>\n        );\n    }\n\n    function renderNoData() {\n        if (providers && (providers).length <= 0) {\n            return (\n                <View style={[styles.directionColumnCenter , styles.Width_100, {height:height-200}]}>\n                    <Image source={require('../../assets/images/note.png')} resizeMode={'contain'}\n                           style={{alignSelf: 'center', width: 200, height: 200}}/>\n                </View>\n            );\n        }\n\n        return null\n    }\n\n    return (\n        <Container style={[styles.bg_gray]}>\n            {renderLoader()}\n            <Content contentContainerStyle={[styles.bgFullWidth , styles.bg_gray]}>\n\n                <Header navigation={navigation} title={ title } filteration={true} onNearProvider={onNearProvider} onFarProvider={onFarProvider} onRateProvider={onRateProvider} />\n\n                <View style={[styles.Width_90,styles.SelfCenter , styles.marginBottom_20 , styles.marginTop_15 , {zIndex:-1}]}>\n                    <Input style={[styles.inputSearch , styles.Width_100 , {flex:0}]}\n                           placeholder={i18n.t('search')}\n                           placeholderTextColor={'#fff'}\n                           onChangeText={(search) => onSearchFilter(search)}\n                           value={search}\n                    />\n\n                    <Image source={require(\"../../assets/images/search.png\")} style={[styles.icon17, {position:'absolute' , right:15 , top:13}]} resizeMode={'cover'} />\n\n                </View>\n\n                <View style={[styles.bgFullWidth ,styles.bg_White, styles.Width_100,styles.paddingHorizontal_20, {overflow:'hidden' , zIndex:-1}]}>\n\n                    {\n                        providers && (providers).length > 0?\n                            <View style={[styles.marginTop_20]}>\n                                <FlatList\n                                    data={providers}\n                                    horizontal={false}\n                                    showsVerticalScrollIndicator={false}\n                                    renderItem={({ item , index}) => <Item\n                                        id={item.id}\n                                        name={item.name}\n                                        image={item.avatar}\n                                        location={item.address}\n                                        rate={item.rate}\n                                        index={index}\n                                    />}\n                                    keyExtractor={item => item.id}\n                                />\n                            </View>\n                            :\n                            renderNoData()\n                    }\n\n\n\n                </View>\n\n            </Content>\n        </Container>\n    );\n}\n\nexport default Category;\n\n\n"]},"metadata":{},"sourceType":"module"}